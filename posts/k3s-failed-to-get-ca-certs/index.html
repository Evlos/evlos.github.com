<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=description content="Issue: node$ journalctl -xu k3s-agent -r | less Mar 11 10:09:35 node-001 k3s[1829]: time=&#34;2025-03-11T10:09:35Z&#34; level=error msg=&#34;failed to get CA certs: Get \&#34;https://127.0.0.1:6444/cacerts\&#34;: read tcp 127.0.0.1:60234->127.0.0.1:6444: read: connection reset by peer&#34; node$ curl https://master:6443/ -k -vv No route to host local$ curl https://master:6443/ -k -vv curl: (35) OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to master:6443 master$ journalctl -xu k3s -r | less Mar 11 12:45:22 master k3s[214073]: time=&#34;2025-03-11T12:45:22Z&#34; level=info msg=&#34;Waiting to retrieve kube-proxy configuration; server is not ready: https://127."><meta property="og:title" content="K3s failed to get CA certs"><meta property="og:description" content="Issue: node$ journalctl -xu k3s-agent -r | less Mar 11 10:09:35 node-001 k3s[1829]: time=&#34;2025-03-11T10:09:35Z&#34; level=error msg=&#34;failed to get CA certs: Get \&#34;https://127.0.0.1:6444/cacerts\&#34;: read tcp 127.0.0.1:60234->127.0.0.1:6444: read: connection reset by peer&#34; node$ curl https://master:6443/ -k -vv No route to host local$ curl https://master:6443/ -k -vv curl: (35) OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to master:6443 master$ journalctl -xu k3s -r | less Mar 11 12:45:22 master k3s[214073]: time=&#34;2025-03-11T12:45:22Z&#34; level=info msg=&#34;Waiting to retrieve kube-proxy configuration; server is not ready: https://127."><meta property="og:type" content="article"><meta property="og:url" content="/posts/k3s-failed-to-get-ca-certs/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-11T17:19:45+08:00"><meta property="article:modified_time" content="2025-03-11T17:19:45+08:00"><title>K3s failed to get CA certs</title><link rel=canonical href=/posts/k3s-failed-to-get-ca-certs/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-66839894-6"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-66839894-6")</script><style type=text/css>pre{width:100%;overflow:hidden}section{width:100%;overflow-x:hidden;word-break:break-all}img{max-width:90%}h2{color:#b3befe;text-transform:uppercase;font-family:fangsong,sans-serif}a{color:#aaa;text-decoration:none}a:hover{text-decoration:underline}ul{padding:0 8px}li.post-item{color:#6b6f84;list-style:none}li.post-item .meta{font-size:85%;padding-right:6px;font-family:monospace;display:inline-block;width:8em;text-align:right}li.post-item a{font-family:monospace;font-size:110%;color:#b3befe}li.post-item.no-bullet{padding-top:8px}body{background-color:#333;color:#eee}pre{background-color:#272822}code{max-width:98%;text-wrap-mode:wrap}footer{color:#555}header h1{text-transform:uppercase;font-family:fangsong,sans-serif;border-left:3px solid #3facfe;color:rgba(255,255,255,.8);display:inline-block;margin:2px;padding:0 8px}</style></head><body lang><section class="main post"><div class=container><div class=content><div class=front-matter><div class=title-container><h2>K3s failed to get CA certs</h2></div><div class=meta><div class=date title='Tue Mar 11 2025 17:19:45 +0800'>Mar 11, 2025</div><div class=reading-time><div class=middot></div></div></div></div><div class=markdown><h2 id=issue>Issue:</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>node$ journalctl -xu k3s-agent -r | less
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>11</span> 10:09:35 node-001 k3s<span style=color:#f92672>[</span>1829<span style=color:#f92672>]</span>: time<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2025-03-11T10:09:35Z&#34;</span> level<span style=color:#f92672>=</span>error msg<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;failed to get CA certs: Get \&#34;https://127.0.0.1:6444/cacerts\&#34;: read tcp 127.0.0.1:60234-&gt;127.0.0.1:6444: read: connection reset by peer&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>node$ curl https://master:6443/ -k -vv
</span></span><span style=display:flex><span>No route to host
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>local$ curl https://master:6443/ -k -vv
</span></span><span style=display:flex><span>curl: <span style=color:#f92672>(</span>35<span style=color:#f92672>)</span> OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to master:6443
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>master$ journalctl -xu k3s -r | less
</span></span><span style=display:flex><span>Mar <span style=color:#ae81ff>11</span> 12:45:22 master k3s<span style=color:#f92672>[</span>214073<span style=color:#f92672>]</span>: time<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2025-03-11T12:45:22Z&#34;</span> level<span style=color:#f92672>=</span>info msg<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Waiting to retrieve kube-proxy configuration; server is not ready: https://127.0.0.1:6443/v1-k3s/readyz: 500 Internal Server Error&#34;</span>
</span></span></code></pre></div><h2 id=solution>Solution:</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>master$ sudo iptables-save &gt; iptables.rules
</span></span><span style=display:flex><span>$ sudo systemctl status iptables
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sudo iptables -F
</span></span><span style=display:flex><span>$ sudo iptables -X
</span></span><span style=display:flex><span>$ sudo iptables -Z
</span></span><span style=display:flex><span>$ sudo iptables -L
</span></span><span style=display:flex><span>$ sudo systemctl restart k3s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sudo systemctl status k3s
</span></span><span style=display:flex><span>$ journalctl -xefu k3s -n <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>$ sudo kubectl get node
</span></span><span style=display:flex><span>NAME       STATUS   ROLES                  AGE      VERSION
</span></span><span style=display:flex><span>node-001   Ready    &lt;none&gt;                 2y114d   v1.25.3+k3s1
</span></span><span style=display:flex><span>master     Ready    control-plane,master   2y114d   v1.28.3+k3s2
</span></span><span style=display:flex><span>node-002   Ready    &lt;none&gt;                 2y114d   v1.28.3+k3s2
</span></span></code></pre></div><br><p class=back-to-posts><a href=/>[back]</a></p></div><br></div></div></section>